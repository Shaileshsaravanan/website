<!DOCTYPE html>
<html lang="en">
  {% include "header.html" %}
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
    <body class="text-white bg-black">    
        <section class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
            <div class="flex justify-between">
                <span onclick="event.stopPropagation(); window.location.href='/scriptorium'" class="cursor-pointer animate-fade-down text-neutral-700 bg-white hover:text-white hover:bg-neutral-700 px-1 rounded-md text-sm font-geist inline-flex items-center transition-colors duration-700 ease-in-out"><svg xmlns="http://www.w3.org/2000/svg" class="h-[1em] mr-0.5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-right-icon lucide-arrow-right"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>back to scriptorium</span>
                <p onclick="window.open('https://github.com/Shaileshsaravanan/{{ project }}', '_blank', 'noopener,noreferrer')" class="text-center cursor-pointer text-neutral-400 hover:text-white hover:bg-neutral-700 rounded-md px-1 transition-colors duration-700 ease-in-out text-sm font-geist animate-fade-down animate-delay-[400ms]">
                    <span class="inline-flex align-middle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-3" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github-icon lucide-github"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/></svg>
                    </span>
                    shaileshsaravanan/{{ project }}
                </p>
            </div>
            <h1 class="pt-10 w-full text-5xl italic text-center animate-fade-down animate-delay-[800ms]">{{ project }}</h1>
            <p class="pb-10 text-center text-neutral-400 text-lg animate-fade-down animate-delay-[1200ms]">{{ project_data.data.desc }}</p>
        </section>
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 prose prose-invert font-geist mb-20 bg-white rounded-lg p-3 animate-fade-up animate-delay-[1700ms] relative">
            <div class="lg:float-left mr-6 mb-4 w-full h-fit lg:w-96 lg:h-fit">
                <div class="relative z-50 h-fit w-full animate-fade-up animate-delay-[2200ms]">
                    <img class="h-fit w-full"
                    src="https://raw.githubusercontent.com/Shaileshsaravanan/{{ project }}/main/.website/preview.png"
                    onerror="this.onerror=null;this.src='https://raw.githubusercontent.com/Shaileshsaravanan/{{ project }}/main/.website/preview.gif';"
                    alt="{{ project }}">
                </div>
            </div>
            <div id="content" class="font-merriweather relative z-10"></div>
        </div>
  </body>
</html>
<script>

    const projectData = {{ project_data | tojson }};

    fetch(projectData.content)
    .then(res => res.text())
    .then(md => {
        const html = marked.parse(md);
        const safe = DOMPurify.sanitize(html);
        document.getElementById("content").innerHTML = safe;

        const content = document.getElementById("content");
        const mainColour = projectData.data.mainColour;
        const subColour = projectData.data.subColour;

        const map = {
            h1: `text-3xl font-extrabold mt-6 mb-4 italic`,
            h2: `text-2xl font-bold mt-5 mb-3 italic`,
            h3: `text-xl font-bold mt-4 mb-3 italic`,
            h4: `text-lg font-semibold mt-4 mb-2 italic`,
            h5: `text-md font-semibold mt-3 mb-2 italic`,
            h6: `text-sm font-semibold mt-3 mb-2 opacity-90 italic`,
            p:  `text-sm leading-normal my-3 leading-7`,
            ul: "my-3 ml-6 list-disc",
            ol: "my-3 ml-6 list-decimal",
            li: "my-1",
            pre:"my-5 p-4 rounded-lg bg-neutral-900",
            table:"my-5",
            strong: "font-bold",
            b: "font-bold",
            em: "italic",
            i: "italic",
            code: "px-1 py-0.5 rounded bg-neutral-800 text-neutral-200",
            a: "underline underline-offset-2 transition-colors duration-700 ease-in-out",
        };

        Object.entries(map).forEach(([tag, classes]) => {
            content.querySelectorAll(tag).forEach(el =>
                el.classList.add(...classes.split(" "))
            );
        });

        content.querySelectorAll("h1,h2,h3,h4,h5,h6,p").forEach(el => {
            el.style.color = mainColour;
        });

        content.querySelectorAll("a").forEach(el => {
            el.style.color = 'white';
            el.style.backgroundColor = mainColour;
            el.style.borderRadius = '0.25rem';
            el.style.paddingRight = '0.2rem';
            el.style.paddingLeft = '0.2rem';
            el.addEventListener("mouseenter", () => {
                el.style.backgroundColor = subColour;
            });

            el.addEventListener("mouseleave", () => {
                el.style.backgroundColor = mainColour;
            });
        });

        content.querySelectorAll("a").forEach(el => {
            el.target = "_blank";
            el.rel = "noopener noreferrer";
        });

        content.querySelectorAll("img").forEach(el => {
            el.classList.add("rounded-lg");
        });

        const all = content.querySelectorAll("*");
        all.forEach(el => {
            el.classList.add("opacity-0");
        });
        all.forEach((el, index) => {
            setTimeout(() => {
                el.classList.remove("opacity-0");
                el.classList.add("animate-fade-up");
            }, 3500 + (index * 200));
        });

    })
    .catch(console.error);

</script>